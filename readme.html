<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>Μητις</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name"></span> <span class="project-version"></span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1  current"><a href="readme.html"><div class="inner"><span>Μητις</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metis</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cli</span></div></div></li><li class="depth-3"><a href="metis.cli.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>config</span></div></div></li><li class="depth-3 branch"><a href="metis.config.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="metis.config.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>document</span></div></div></li><li class="depth-3 branch"><a href="metis.document.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="metis.document.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>exchange</span></div></div></li><li class="depth-3 branch"><a href="metis.exchange.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-3 branch"><a href="metis.exchange.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="metis.exchange.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>log</span></div></div></li><li class="depth-3 branch"><a href="metis.log.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="metis.log.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>ltmem</span></div></div></li><li class="depth-3 branch"><a href="metis.ltmem.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="metis.ltmem.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>model</span></div></div></li><li class="depth-3 branch"><a href="metis.model.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="metis.model.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>page</span></div></div></li><li class="depth-3 branch"><a href="metis.page.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="metis.page.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-3"><a href="metis.page.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>scheduler</span></div></div></li><li class="depth-3 branch"><a href="metis.scheduler.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="metis.scheduler.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-3"><a href="metis.scheduler.proc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>proc</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>srv</span></div></div></li><li class="depth-3 branch"><a href="metis.srv.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="metis.srv.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>stmem</span></div></div></li><li class="depth-3 branch"><a href="metis.stmem.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-3 branch"><a href="metis.stmem.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="metis.stmem.flow-control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>flow-control</span></div></a></li><li class="depth-3 branch"><a href="metis.stmem.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-3 branch"><a href="metis.stmem.notif.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>notif</span></div></a></li><li class="depth-3"><a href="metis.stmem.trans.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>trans</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>tasks</span></div></div></li><li class="depth-3 branch"><a href="metis.tasks.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="metis.tasks.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>utils</span></div></div></li><li class="depth-3 branch"><a href="metis.utils.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="metis.utils.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>worker</span></div></div></li><li class="depth-3 branch"><a href="metis.worker.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.ctrl-mp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ctrl-mp</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.date-time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>date-time</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.devhub.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>devhub</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.devproxy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>devproxy</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.exchange.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exchange</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.gen-db-doc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gen-db-doc</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.message.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>message</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.replicate.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>replicate</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.resp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>resp</span></div></a></li><li class="depth-3 branch"><a href="metis.worker.select-definition.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>select-definition</span></div></a></li><li class="depth-3"><a href="metis.worker.wait.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>wait</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -424px;"><span class="top" style="height: 433px;"></span><span class="bottom"></span></span><span>ws</span></div></div></li><li class="depth-3 branch"><a href="metis.ws.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="metis.ws.interface.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interface</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#μητις" name="μητις"></a>Μητις</h1>
<img src="metis.png" alt="metis" id="logo" />
<p><a href="https://github.com/wactbprot/metis/actions/workflows/main.yml"><img src="https://github.com/wactbprot/metis/actions/workflows/main.yml/badge.svg" alt="codox" /></a></p>
<p><a href="https://wactbprot.github.io/metis/">api documentation</a></p>
<h1><a href="#requirements" name="requirements"></a>requirements</h1>
<ul>
  <li><a href="https://clojure.org/guides/getting_started">Clojure</a></li>
  <li><a href="https://redis.io/">Redis</a> (with activated <a href="https://redis.io/topics/notifications">Keyspace Notifications</a>)</li>
</ul>
<h1><a href="#installation" name="installation"></a>installation</h1>
<p>All of the <code>mp</code> state is kept in a <a href="https://redis.io">redis</a> database.</p>
<h2><a href="#redis-config" name="redis-config"></a>redis config</h2>
<p>Μητις relies on <a href="https://redis.io/topics/notifications">Keyspace Notifications</a>. Therefore it is necassary to replace in <code>/etc/redis/redis.conf</code>:</p>
<pre><code class="shell">notify-keyspace-events ""
</code></pre>
<p>by</p>
<pre><code class="shell">notify-keyspace-events AK
</code></pre>
<p>and restart the service:</p>
<pre><code class="shell"># restart
$ sudo systemctl restart redis.service

# check status
$ sudo systemctl status redis.service
</code></pre>
<h2><a href="#frontend-web-site-" name="frontend-web-site-"></a>frontend (web site)</h2>
<p>The metis frontend is based on <a href="https://getuikit.com/">UIkit</a>. A fresh metis installation needs libraries: run <code>./dl.sh</code> in metis root path in order to install them. See the <a href="frontend.html">frontend documentation</a>. </p>
<h3><a href="#url" name="url"></a>url</h3>
<ul>
  <li>home: <a href="http://localhost:8010/">http://localhost:8010/</a></li>
  <li>container view: <a href="http://localhost:8010/cont/mpd-ref">http://localhost:8010/cont/mpd-ref</a></li>
  <li>input/output elements: <a href="http://localhost:8010/elem/mpd-ref">http://localhost:8010/elem/mpd-ref</a></li>
</ul>
<h2><a href="#backend" name="backend"></a>backend</h2>
<h3><a href="#environment-variables" name="environment-variables"></a>environment variables</h3>
<p>There are a plenty of methods to set and activate environment variables. E.g.: write them to a file called <code>.metis</code> in the home directory (<code>~/</code>) and load it by means of your <code>~/.bashrc</code> including the line <code>source ~/.metis</code>.</p>
<table>
  <thead>
    <tr>
      <th><code>var</code> </th>
      <th>Description </th>
      <th>Example </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>METIS_BUILD_ON_START</code></td>
      <td>mpds to build on server start </td>
      <td><code>export METIS_BUILD_ON_START="mpd-ppc-gas_dosing"</code><br /><code>export METIS_BUILD_ON_START="mpd-se3-servo,mpd-se3-cmp_valves,mpd-se3-cmp_state"</code> </td>
    </tr>
    <tr>
      <td><code>METIS_DEVHUB_URL</code> </td>
      <td>url for device requests <br />(Action: TCP, VXI11, MODBUS EXECUTE) </td>
      <td><code>export METIS_DEVHUB_URL="http://localhost:9009"</code><br /><code>export METIS_DEVHUB_URL="http://a73434:55555"</code> </td>
    </tr>
    <tr>
      <td><code>METIS_LTMEM_HOST</code> </td>
      <td>CouchDB host </td>
      <td><code>export METIS_LTMEM_HOST="127.0.0.1"</code><br /><code>export METIS_LTMEM_HOST="a73434"</code> </td>
    </tr>
    <tr>
      <td><code>METIS_DEVPROXY_URL</code> </td>
      <td>DevProxy url </td>
      <td><code>export METIS_DEVPROXY_URL="http://localhost:8009"</code> </td>
    </tr>
    <tr>
      <td><code>CAL_USR</code> </td>
      <td>For password protected <code>vl_db_work</code> and <code>vl_db</code> </td>
      <td><code>export CAL_USR="cal"</code> </td>
    </tr>
    <tr>
      <td><code>CAL_PWD</code> </td>
      <td>see above </td>
      <td><code>export CAL_USR="&lt;passwd&gt;"</code> </td>
    </tr>
  </tbody>
</table>
<h2><a href="#notes" name="notes"></a>notes</h2>
<h3><a href="#set-proxy-get-deps-from-maven-central-" name="set-proxy-get-deps-from-maven-central-"></a>set proxy (get deps from maven central)</h3>
<pre><code class="shell">touch ~/.m2/settings.xml 
</code></pre>
<p>fill with:</p>
<pre><code class="xml">&lt;settings&gt;
  &lt;proxies&gt;
    &lt;proxy&gt;
      &lt;id&gt; ____ &lt;/id&gt;
      &lt;host&gt; ____ &lt;/host&gt;
      &lt;port&gt; ____ &lt;/port&gt;
      &lt;nonProxyHosts&gt;localhost|*.__.__&lt;/nonProxyHosts&gt;
    &lt;/proxy&gt;
  &lt;/proxies&gt;
&lt;/settings&gt;
</code></pre>
<h3><a href="#overcome-error-by-" name="overcome-error-by-"></a>overcome <code>SSL peer shut down incorrectly</code> error by:</h3>
<pre><code class="shell">export JAVA_TOOL_OPTIONS=-Dhttps.protocols=TLSv1,TLSv1.1,TLSv1.2
</code></pre>
<h3><a href="#emacs" name="emacs"></a>emacs</h3>
<pre><code class="elisp">((clojure-mode . ((cider-preferred-build-tool . clojure-cli)
                  (cider-clojure-cli-global-options . "-A:dev"))))
</code></pre>
<h3><a href="#codox" name="codox"></a>codox</h3>
<pre><code class="shell">clojure -X:dev:codox
</code></pre>
<h3><a href="#code-coverage" name="code-coverage"></a>code coverage</h3>
<pre><code class="shell">clojure -M:dev:coverage
</code></pre></div></div></div></body></html>